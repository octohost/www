box: wercker/nodejs
# Build definition
build:
  # The steps that will be executed on build
  steps:
    - script:
        name: harp compile
        code: |
          npm install
          ./node_modules/.bin/harp compile
deploy :
  steps :
    - script:
        name: Deploy to octohost.
        code: |-
          privateKey=$(eval echo "\$${KEY}_PRIVATE")
          echo -e 'Host *\n  StrictHostKeyChecking no\n  UserKnownHostsFile=/dev/null\n  IdentityFile /home/ubuntu/.ssh/id_rsa' >> ~/.ssh/config
          echo -e "$privateKey" > /home/ubuntu/.ssh/id_rsa && chmod 600 /home/ubuntu/.ssh/id_rsa && cat /home/ubuntu/.ssh/id_rsa
          git push $GIT_REMOTE master
  after-steps:
        - sherzberg/slack-notify:
            subdomain: $SLACK_SUBDOMAIN
            token: $SLACK_TOKEN
            channel: $SLACK_CHANNEL
